From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: davis <1972806+peoplesmeat@users.noreply.github.com>
Date: Tue, 24 Jan 2023 13:53:23 -0500
Subject: [PATCH] 4928: Remove canonicalHostname for new projects

Addresses https://github.com/NationalSecurityAgency/ghidra/issues/4924
---
 .../java/ghidra/framework/client/ClientUtil.java     |  4 ++--
 .../ghidra/framework/client/ServerConnectTask.java   | 12 +-----------
 2 files changed, 3 insertions(+), 13 deletions(-)

diff --git a/Ghidra/Framework/FileSystem/src/main/java/ghidra/framework/client/ClientUtil.java b/Ghidra/Framework/FileSystem/src/main/java/ghidra/framework/client/ClientUtil.java
index af1056cb4..038b47d91 100644
--- a/Ghidra/Framework/FileSystem/src/main/java/ghidra/framework/client/ClientUtil.java
+++ b/Ghidra/Framework/FileSystem/src/main/java/ghidra/framework/client/ClientUtil.java
@@ -108,7 +108,7 @@ public class ClientUtil {
 
 		host = host.trim().toLowerCase();
 		try {
-			host = InetNameLookup.getCanonicalHostName(host);
+			InetNameLookup.getCanonicalHostName(host);
 		}
 		catch (UnknownHostException e) {
 			Msg.warn(ClientUtil.class, "Failed to resolve hostname for " + host);
@@ -151,7 +151,7 @@ public class ClientUtil {
 		host = host.trim().toLowerCase();
 		String hostAddr = host;
 		try {
-			hostAddr = InetNameLookup.getCanonicalHostName(host);
+			InetNameLookup.getCanonicalHostName(host);
 		}
 		catch (UnknownHostException e) {
 			throw new IOException("Repository server lookup failed: " + host);
diff --git a/Ghidra/Framework/FileSystem/src/main/java/ghidra/framework/client/ServerConnectTask.java b/Ghidra/Framework/FileSystem/src/main/java/ghidra/framework/client/ServerConnectTask.java
index 08d9af57f..f76c12aee 100644
--- a/Ghidra/Framework/FileSystem/src/main/java/ghidra/framework/client/ServerConnectTask.java
+++ b/Ghidra/Framework/FileSystem/src/main/java/ghidra/framework/client/ServerConnectTask.java
@@ -122,16 +122,6 @@ class ServerConnectTask extends Task {
 		return subj;
 	}
 
-	private static String getPreferredHostname(String name) {
-		try {
-			return InetNameLookup.getCanonicalHostName(name);
-		}
-		catch (UnknownHostException e) {
-			Msg.warn(ServerConnectTask.class, "Failed to resolve hostname for " + name);
-		}
-		return name;
-	}
-
 	private static boolean isSSLHandshakeCancelled(SSLHandshakeException e) throws IOException {
 		if (e.getMessage().indexOf("bad_certificate") > 0) {
 			if (ApplicationKeyManagerFactory.getPreferredKeyStore() == null) {
@@ -274,7 +264,7 @@ class ServerConnectTask extends Task {
 				}
 			}
 
-			String serverName = getPreferredHostname(server.getServerName());
+			String serverName = server.getServerName();
 			AnonymousCallback onlyAnonymousCb = null;
 			while (true) {
 				try {
-- 
2.39.0

