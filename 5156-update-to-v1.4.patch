From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: tom <tomnelson@users.noreply.github.com>
Date: Wed, 22 Mar 2023 09:24:02 -0400
Subject: [PATCH] 5156: update to v1.4

---
 Ghidra/Features/GraphServices/Module.manifest   |  4 ++--
 Ghidra/Features/GraphServices/build.gradle      |  4 ++--
 .../visualization/DefaultGraphDisplay.java      | 17 +++++------------
 3 files changed, 9 insertions(+), 16 deletions(-)

diff --git a/Ghidra/Features/GraphServices/Module.manifest b/Ghidra/Features/GraphServices/Module.manifest
index abb13cde5..ceed539cd 100644
--- a/Ghidra/Features/GraphServices/Module.manifest
+++ b/Ghidra/Features/GraphServices/Module.manifest
@@ -1,7 +1,7 @@
 EXCLUDE FROM GHIDRA JAR: true
 
-MODULE FILE LICENSE: lib/jungrapht-visualization-1.3.jar BSD-3-JUNG
-MODULE FILE LICENSE: lib/jungrapht-layout-1.3.jar BSD-3-JUNG
+MODULE FILE LICENSE: lib/jungrapht-visualization-1.4.jar BSD-3-JUNG
+MODULE FILE LICENSE: lib/jungrapht-layout-1.4.jar BSD-3-JUNG
 MODULE FILE LICENSE: lib/jgrapht-core-1.5.1.jar LGPL 2.1
 MODULE FILE LICENSE: lib/jgrapht-io-1.5.1.jar LGPL 2.1
 MODULE FILE LICENSE: lib/jheaps-0.13.jar Apache License 2.0
diff --git a/Ghidra/Features/GraphServices/build.gradle b/Ghidra/Features/GraphServices/build.gradle
index ba3cf21bf..cd019a0b3 100644
--- a/Ghidra/Features/GraphServices/build.gradle
+++ b/Ghidra/Features/GraphServices/build.gradle
@@ -27,8 +27,8 @@ dependencies {
 	api project(":Base")
 
 	// jungrapht - exclude slf4j which produces a conflict with other uses with Ghidra
-	api ("com.github.tomnelson:jungrapht-visualization:1.3") { exclude group: "org.slf4j", module: "slf4j-api" }
-	api ("com.github.tomnelson:jungrapht-layout:1.3") { exclude group: "org.slf4j", module: "slf4j-api" }
+	api ("com.github.tomnelson:jungrapht-visualization:1.4") { exclude group: "org.slf4j", module: "slf4j-api" }
+	api ("com.github.tomnelson:jungrapht-layout:1.4") { exclude group: "org.slf4j", module: "slf4j-api" }
 
 	api "org.jgrapht:jgrapht-core:1.5.1"
 
diff --git a/Ghidra/Features/GraphServices/src/main/java/ghidra/graph/visualization/DefaultGraphDisplay.java b/Ghidra/Features/GraphServices/src/main/java/ghidra/graph/visualization/DefaultGraphDisplay.java
index 43dfe2ab0..33df25fe9 100644
--- a/Ghidra/Features/GraphServices/src/main/java/ghidra/graph/visualization/DefaultGraphDisplay.java
+++ b/Ghidra/Features/GraphServices/src/main/java/ghidra/graph/visualization/DefaultGraphDisplay.java
@@ -250,17 +250,6 @@ public class DefaultGraphDisplay implements GraphDisplay {
 	private LensSupport<LensGraphMouse> createMagnifier() {
 		Lens lens = Lens.builder().lensShape(Lens.Shape.RECTANGLE).magnification(3.f).build();
 		lens.setMagnification(2.f);
-		LensMagnificationGraphMousePlugin magnificationPlugin =
-			new LensMagnificationGraphMousePlugin(1.f, 60.f, .2f) {
-				// Override to address a bug when using a high resolution mouse wheel.
-				// May be removed when jungrapht-visualization version is updated
-				@Override
-				public void mouseWheelMoved(MouseWheelEvent e) {
-					if (e.getWheelRotation() != 0) {
-						super.mouseWheelMoved(e);
-					}
-				}
-			};
 
 		MutableTransformer transformer =
 			viewer.getRenderContext().getMultiLayerTransformer().getTransformer(VIEW);
@@ -270,7 +259,11 @@ public class DefaultGraphDisplay implements GraphDisplay {
 				.delegate(transformer)
 				.build();
 		LensGraphMouse lensGraphMouse =
-			DefaultLensGraphMouse.builder().magnificationPlugin(magnificationPlugin).build();
+			DefaultLensGraphMouse.builder()
+					.magnificationFloor(1.f)
+					.magnificationCeiling(60.f)
+					.magnificationDelta(.2f)
+					.build();
 		return MagnifyImageLensSupport.builder(viewer)
 				.lensTransformer(shapeTransformer)
 				.lensGraphMouse(lensGraphMouse)
-- 
2.39.1

