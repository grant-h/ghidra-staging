From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Thompson Lee <tom.mai78101@gmail.com>
Date: Thu, 23 Feb 2023 11:41:13 -0500
Subject: [PATCH] 5026: Fixed incorrect parsing of the Erase In Line ANSI code.

All credits go to nsadeveloper789 for the patch.
---
 .../java/agent/gdb/pty/windows/AnsiBufferedInputStream.java    | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/Ghidra/Debug/Debugger-agent-gdb/src/main/java/agent/gdb/pty/windows/AnsiBufferedInputStream.java b/Ghidra/Debug/Debugger-agent-gdb/src/main/java/agent/gdb/pty/windows/AnsiBufferedInputStream.java
index 0737f1965..a0bb1a2d2 100644
--- a/Ghidra/Debug/Debugger-agent-gdb/src/main/java/agent/gdb/pty/windows/AnsiBufferedInputStream.java
+++ b/Ghidra/Debug/Debugger-agent-gdb/src/main/java/agent/gdb/pty/windows/AnsiBufferedInputStream.java
@@ -365,6 +365,9 @@ public class AnsiBufferedInputStream extends InputStream {
 
 	protected int parseNumericBuffer() {
 		String numeric = readAndClearEscBuf();
+		if (numeric.isEmpty()) {
+			return 0;
+		}
 		int result = Integer.parseInt(numeric);
 		return result;
 	}
-- 
2.39.1

