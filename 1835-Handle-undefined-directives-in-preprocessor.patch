diff --git a/Ghidra/Framework/SoftwareModeling/src/main/java/ghidra/sleigh/grammar/SleighPreprocessor.java b/Ghidra/Framework/SoftwareModeling/src/main/java/ghidra/sleigh/grammar/SleighPreprocessor.java
index f0ca7bc98fa..980d02eb359 100644
--- a/Ghidra/Framework/SoftwareModeling/src/main/java/ghidra/sleigh/grammar/SleighPreprocessor.java
+++ b/Ghidra/Framework/SoftwareModeling/src/main/java/ghidra/sleigh/grammar/SleighPreprocessor.java
@@ -411,6 +411,9 @@ public String lookup(String variable) {
 
 	@Override
 	public void reportError(String msg) {
+		if (isInif()) {
+			return;
+		}
 		errorCount += 1;
 		Location location = new Location(file.getName(),lineno);
 		Msg.error(this, location + ": " + msg);
diff --git a/Ghidra/Framework/SoftwareModeling/src/test/resources/ifdef.input b/Ghidra/Framework/SoftwareModeling/src/test/resources/ifdef.input
new file mode 100644
index 00000000000..921ae750cdf
--- /dev/null
+++ b/Ghidra/Framework/SoftwareModeling/src/test/resources/ifdef.input
@@ -0,0 +1,29 @@
+@ifdef FOO
+@if FOO == "foo"
+true
+@endif
+@endif
+@ifndef FOO
+false
+@else
+@if FOO == "foo"
+true
+@endif
+@endif
+@ifndef FOO
+false
+@elif FOO == "foo"
+true
+@endif
+@if (defined(FOO) && FOO == "foo")
+true
+@endif
+@if FOO == "foo"
+true
+@endif
+@if FOO == "foo" && BAR == "bar"
+true
+@endif
+@if !(FOO == "bar" || BAR != "bar")
+true
+@endif
diff --git a/Ghidra/Framework/SoftwareModeling/src/test/resources/ifdef.output b/Ghidra/Framework/SoftwareModeling/src/test/resources/ifdef.output
new file mode 100644
index 00000000000..dfda7a43809
--- /dev/null
+++ b/Ghidra/Framework/SoftwareModeling/src/test/resources/ifdef.output
@@ -0,0 +1,30 @@
+ifdef.input###1#@ifdef FOO
+#@if FOO == "foo"
+#true
+#@endif
+#@endif
+#@ifndef FOO
+false
+#@else
+#@if FOO == "foo"
+#true
+#@endif
+#@endif
+#@ifndef FOO
+false
+#@elif FOO == "foo"
+#true
+#@endif
+#@if (defined(FOO) && FOO == "foo")
+#true
+#@endif
+#@if FOO == "foo"
+#true
+#@endif
+#@if FOO == "foo" && BAR == "bar"
+#true
+#@endif
+#@if !(FOO == "bar" || BAR != "bar")
+#true
+#@endif
+
